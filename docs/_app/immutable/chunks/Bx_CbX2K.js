import{U as u,as as b,ay as l,at as m,a3 as _,aj as p,M as d,a9 as g,aH as T,al as A,y as k,ac as E,E as R,ad as w,aI as M,ae as S,af as D,a8 as F,a7 as v}from"./DUqkvchf.js";class I{anchor;#s=new Map;#t=new Map;#e=new Map;#a=new Set;#i=!0;constructor(s,a=!0){this.anchor=s,this.#i=a}#r=()=>{var s=u;if(this.#s.has(s)){var a=this.#s.get(s),e=this.#t.get(a);if(e)b(e),this.#a.delete(a);else{var n=this.#e.get(a);n&&(this.#t.set(a,n.effect),this.#e.delete(a),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),e=n.effect)}for(const[i,t]of this.#s){if(this.#s.delete(i),i===s)break;const r=this.#e.get(t);r&&(l(r.effect),this.#e.delete(t))}for(const[i,t]of this.#t){if(i===a||this.#a.has(i))continue;const r=()=>{if(Array.from(this.#s.values()).includes(i)){var c=document.createDocumentFragment();T(t,c),c.append(_()),this.#e.set(i,{effect:t,fragment:c})}else l(t);this.#a.delete(i),this.#t.delete(i)};this.#i||!e?(this.#a.add(i),m(t,r,!1)):r()}}};#f=s=>{this.#s.delete(s);const a=Array.from(this.#s.values());for(const[e,n]of this.#e)a.includes(e)||(l(n.effect),this.#e.delete(e))};ensure(s,a){var e=u,n=A();if(a&&!this.#t.has(s)&&!this.#e.has(s))if(n){var i=document.createDocumentFragment(),t=_();i.append(t),this.#e.set(s,{effect:p(()=>a(t)),fragment:i})}else this.#t.set(s,p(()=>a(this.anchor)));if(this.#s.set(e,s),n){for(const[r,f]of this.#t)r===s?e.unskip_effect(f):e.skip_effect(f);for(const[r,f]of this.#e)r===s?e.unskip_effect(f.effect):e.skip_effect(f.effect);e.oncommit(this.#r),e.ondiscard(this.#f)}else d&&(this.anchor=g),this.#r()}}function x(h,s,a=!1){d&&E();var e=new I(h),n=a?R:0;function i(t,r){if(d){const o=w(h);var f;if(o===M?f=0:o===S?f=!1:f=parseInt(o.substring(1)),t!==f){var c=D();F(c),e.anchor=c,v(!1),e.ensure(t,r),v(!0);return}}e.ensure(t,r)}k(()=>{var t=!1;s((r,f=0)=>{t=!0,i(f,r)}),t||i(!1,null)},n)}export{I as B,x as i};
